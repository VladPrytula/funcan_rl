# Response to Reviewers: Week 2, Day 2 (Tonelli's Theorem)

**Date:** October 10, 2025
**Author:** Professor Jean-Pierre Dubois
**Submission:** Revised manuscript addressing GTM review

---

## To: Dr. Elena Sokolov, Springer GTM Series Editor

Dear Dr. Sokolov,

Thank you for your thorough and insightful review of the Week 2, Day 2 material on Tonelli's Theorem. Your feedback has significantly strengthened both the mathematical rigor and pedagogical clarity of the exposition. I have carefully addressed all critical issues and incorporated your suggestions where they enhance the text. Below I provide a point-by-point response to your review.

---

## I. Response to Critical Issues

### Issue 1: Borel σ-algebra Convention (Theorem 2.3, Statement Part 1)

**Your feedback:** Add a remark clarifying that $[0,\infty]$ carries the standard Borel structure.

**Our response:** **Fully addressed.** I have added **Remark 2.8 (Borel σ-algebra Convention)** immediately following Theorem 2.3, which explicitly states:

> "We equip $[0,\infty]$ with the Borel σ-algebra $\mathcal{B}([0,\infty])$ generated by the standard topology, where $[0,\infty] = [0,\infty) \cup \{\infty\}$ with $\infty$ as an isolated point... Under this convention, all measurability statements in Theorem 2.3 are with respect to Borel sets."

The remark cites Folland §1.1 and Durrett §1.1 for readers seeking additional detail. This eliminates any ambiguity for students encountering the extended reals for the first time.

**Location in revised text:** Remark 2.8, immediately after Theorem 2.3 statement.

---

### Issue 2: Step 2 Approximation Claim (Measurable Sets vs. Rectangles)

**Your feedback:** The claim that every set in $\mathcal{F}_X \otimes \mathcal{F}_Y$ is a countable union of disjoint rectangles is false. Require more precision or defer to Folland §2.4, Lemma 2.36.

**Our response:** **Fully corrected.** I have replaced the incorrect claim with a precise statement:

> "By Folland §2.4, Lemma 2.36 (or Day 1, Lemma 2.4), any simple function $s$ on $X \times Y$ can be written as a finite linear combination of indicator functions of measurable sets... For pedagogical clarity, we first establish the result for simple functions of the form $s = \sum_{i=1}^{n} a_i \mathbf{1}_{A_i \times B_i}$ where $A_i \times B_i$ are disjoint rectangles... The extension to general simple functions follows by approximation and MCT—see Folland §2.4 for the complete technical details."

This approach maintains pedagogical clarity (proving the rectangle case explicitly) while honestly acknowledging the technical gap and deferring the general extension to Folland. This is consistent with the syllabus philosophy of "postponed generalizations" documented in the Syllabus.md.

**Location in revised text:** Proof of Theorem 2.3, Step 2.

---

### Issue 3: Example 2.3 Notation Consistency

**Your feedback:** Add explicit domain statement $\text{for } x \in X, y \in Y$ to the function definition.

**Our response:** **Fully addressed.** The function definition now reads:

$$
f(x, y) = \begin{cases}
x & \text{if } y = a \\
2x & \text{if } y = b
\end{cases} \quad \text{for } x \in X, \, y \in Y
$$

**Location in revised text:** Example 2.3, function definition.

---

### Issue 4: Exercise 2(b) — Complete Counterexample for Signed Terms

**Your feedback:** The incomplete attempts to construct a counterexample are unacceptable for GTM standards. Either provide the complete counterexample or defer explicitly to Day 3.

**Our response:** **Fully addressed with complete counterexample.** I have provided a rigorous construction with full verification:

**Array:**
$$
a_{ij} = \begin{cases}
1 & \text{if } j = i \\
-1 & \text{if } j = i+1 \\
0 & \text{otherwise}
\end{cases}
$$

**Verification:**
- Row sums: $\sum_j a_{ij} = 0$ for all $i$ → $\sum_i \sum_j a_{ij} = 0$
- Column sums: $j=1$ gives 1, $j \geq 2$ gives 0 → $\sum_j \sum_i a_{ij} = 1$

**Conclusion:** The iterated sums differ ($0 \neq 1$), confirming that **non-negativity is essential**. I added the key observation that $\sum_{i,j} |a_{ij}| = \infty$ (not absolutely convergent), which directly previews the necessity of the integrability hypothesis in Fubini's theorem.

This example is pedagogically superior to the incomplete attempts—it's clean, verifiable by hand, and makes the point precisely. The counterexample is now publication-ready.

**Location in revised text:** Exercise 2(b), complete solution with visualization and verification.

---

### Issue 5: Exercise 3(b) — Conditional Measures vs. Product Measures

**Your feedback:** The measure $\rho(ds, da) = d^\pi(ds) \cdot \pi_\theta(da|s)$ is NOT a product measure—it's a conditional measure (disintegration). Direct application of Tonelli is incorrect.

**Our response:** **Fully corrected with honest acknowledgment of technical subtlety.** I have rewritten part (b) to:

1. **Correctly identify** $\rho$ as a disintegration of $d^\pi$ with conditional distribution $\pi_\theta(\cdot|s)$
2. **Cite the appropriate theorem** (Kallenberg Theorem 6.4, disintegration theorem)
3. **Add an "Important technical note"** paragraph explicitly acknowledging:
   > "The measure $\rho$ is NOT a product measure in the sense of Day 1—it's a conditional measure (disintegration). The correct framework for iterated integration with conditional measures requires the **disintegration theorem** or conditional expectation (Week 4, Day 4)."

4. **Provide forward reference** to Week 4 where conditional expectation will be developed rigorously

This approach maintains the pedagogical value of Exercise 3 (connecting Tonelli to policy gradients) while being mathematically honest about the technical gap. Rather than glossing over the subtlety, I acknowledge it explicitly and promise resolution in Week 4. This respects the reader's intelligence and aligns with the Bourbaki-Brezis philosophy of transparency in exposition.

**Location in revised text:** Exercise 3(b), complete rewrite with technical note.

---

## II. Response to Suggestions

### Suggestion 1: Strengthen Remark 2.9 with Geometric Intuition

**Your feedback:** Add geometric intuition to why non-negativity is crucial.

**Our response:** **Incorporated.** Added to Remark 2.9:

> "Geometrically, non-negativity ensures all contributions to the integral are accumulating (no cancellation), allowing monotone approximation. When $f$ oscillates in sign, positive and negative regions can interact pathologically, requiring the stronger hypothesis $\int |f| < \infty$ to control total variation."

This adds concrete geometric insight without sacrificing rigor.

---

### Suggestion 2: Fix Precision in Step 3 Measurability Claim

**Your feedback:** The measurability of sections follows from Theorem 2.3 part 1, not "by Step 2."

**Our response:** **Corrected.** Changed to:

> "For each $n$, the section $s_n(x, \cdot): Y \to [0, \infty)$ is a simple function, hence measurable (by part 1 of Theorem 2.3 applied to the simple function $s_n$, which we established in Step 1 for indicator functions and extended to simple functions via linearity)."

This clarifies the logical dependency accurately.

---

### Suggestion 3: Make Proposition 2.6 Domain Explicit

**Your feedback:** State the domain explicitly for each $f_{ij}$.

**Our response:** **Incorporated.** Changed to:

> "Let $\{f_{ij}\}_{i,j \in \mathbb{N}}$ be a double sequence where each $f_{ij}: X \times Y \to [0, \infty]$ is $(\mathcal{F}_X \otimes \mathcal{F}_Y)$-measurable."

---

### Suggestion 4: Add Forward Reference to Remark 2.12

**Your feedback:** Consider adding a forward reference to where this distinction matters.

**Our response:** **Incorporated.** Added to Remark 2.12:

> "This distinction becomes critical in Week 4 (conditional expectation) and Week 32 (stochastic approximation), where controlling both positive and negative parts of martingale differences requires integrability conditions."

This connects today's abstract result to future concrete applications in RL theory.

---

### Suggestion 5: Add Type Hints and Docstrings to Code

**Your feedback:** Add type annotations and docstrings to `verify_tonelli` function.

**Our response:** **Incorporated.** Added:

```python
def verify_tonelli(X: np.ndarray, Y: np.ndarray,
                   mu: np.ndarray, nu: np.ndarray,
                   f: np.ndarray) -> dict:
    """
    Numerically verify Tonelli's theorem for a discrete function f: X × Y → [0,∞).

    Parameters:
        X: State space (array of values)
        Y: Action space (array of values)
        mu: Probability measure on X
        nu: Probability measure on Y
        f: Function values f[i,j] = f(X[i], Y[j])

    Returns:
        dict with keys 'iterated_xy', 'iterated_yx', 'double', 'verified'
    """
```

This brings the code to professional Python 3.10+ standards and explicitly maps mathematical notation to code variables.

---

### Suggestion 6: Clarify Multiplication Map Continuity in Exercise 1

**Your feedback:** Add justification for continuity of multiplication on $[0,\infty]$.

**Our response:** **Incorporated.** Expanded Step 2 in Exercise 1(a) to:

> "The multiplication map $m: [0,\infty] \times [0,\infty] \to [0,\infty]$ defined by $m(a,b) = a \cdot b$ is continuous (hence Borel measurable) with respect to the standard topology on $[0,\infty]$ extended by the one-point compactification (where $[0,\infty] = [0,\infty) \cup \{\infty\}$ with $\infty$ as an isolated point in the relative topology induced by $[-\infty, \infty]$). By convention, $0 \cdot \infty = 0$."

This provides the necessary topological context for readers unfamiliar with the one-point compactification.

---

## III. Commendations and Preservation of Strengths

I deeply appreciate your commendations of the following aspects, which I have carefully preserved in the revision:

1. **Three-step proof strategy** (rectangles → simple functions → MCT): The structure remains unchanged, with only the Step 2 claim corrected.

2. **Remark 2.10 (σ-finiteness)**: Forward signposting to Day 3 counterexample preserved.

3. **Remark 2.11 (order independence)**: Emphasis on non-trivial nature of symmetry preserved.

4. **Exercise 1 solution**: Complete proof structure and RL interpretation in part (c) preserved.

5. **Example 2.3 computational verification**: Code and visualizations preserved, with type hints/docstrings added.

6. **Section VI forward connections**: Open questions remain unchanged.

Your positive assessment of these elements confirms that the pedagogical approach is sound. I have ensured these strengths are not diminished in the revision.

---

## IV. Additional Improvements

Beyond addressing your feedback, I made two additional improvements:

1. **Renumbered remarks consistently** after adding Remark 2.8, ensuring logical flow.

2. **Enhanced Exercise 3 honesty** by explicitly acknowledging the disintegration subtlety with a forward reference to Week 4.

These changes strengthen the text without introducing new issues.

---

## V. Feedback Not Incorporated

### (None)

All critical issues have been addressed, and all suggestions have been incorporated. There were no suggestions that I felt should be declined. Your feedback was precise, constructive, and aligned perfectly with the goals of this textbook.

---

## VI. Gratitude

Thank you for:

1. **Precise identification of mathematical errors** (Step 2 approximation claim, Exercise 3(b) conditional measure issue): These were critical fixes that significantly improve the rigor.

2. **Constructive suggestions** that enhanced clarity without sacrificing precision (geometric intuition in Remark 2.9, forward references in Remark 2.12).

3. **Recognition of pedagogical strengths**: Your commendations of the three-step proof strategy, Exercise 1 solution, and computational verification confirm that the Bourbaki-Brezis-Lions approach is working.

4. **Detailed feedback on Exercise 2(b)**: Your insistence on a complete counterexample forced me to construct a clean, rigorous example that is now pedagogically superior to any of my incomplete attempts.

Your review has elevated this material to GTM publication standards. I am confident the revised text is now ready for inclusion in the textbook.

---

## VII. Summary of Revisions

| Category | Count | Status |
|----------|-------|--------|
| Critical Issues Fixed | 5 | ✅ All addressed |
| Suggestions Incorporated | 6 | ✅ All incorporated |
| Strengths Preserved | 6 | ✅ All preserved |
| Additional Improvements | 2 | ✅ Completed |

**Overall assessment:** All critical issues resolved. All suggestions incorporated. Strengths preserved. Text is mathematically rigorous, pedagogically clear, and ready for publication.

---

## VIII. Files Submitted

1. **`Day_2_REVISED.md`** — Complete revised main content (Tonelli's Theorem)
2. **`Day_2_exercises_REVISED.md`** — Complete revised exercises with corrected counterexample
3. **`REVISION_LOG_Day_2.md`** — Detailed log of all changes
4. **`Response_to_Reviewers_Day_2.md`** — This document

---

## IX. Request for Re-Review

I respectfully request re-review of the revised manuscript. I believe all issues raised in your initial review have been addressed comprehensively. The revised text maintains the architectural vision and pedagogical clarity of the original while eliminating the mathematical errors and imprecisions you identified.

If any issues remain, I am prepared to address them promptly in a second round of revisions. My goal is to produce textbook material that meets the highest standards of Springer GTM and serves as a definitive reference for graduate students connecting measure theory to reinforcement learning.

Thank you again for your thorough and constructive review.

Sincerely,

**Professor Jean-Pierre Dubois**
Laboratoire Jacques-Louis Lions (LJLL)
Sorbonne Université

---

**Date:** October 10, 2025
**Submission:** Revised manuscript for Week 2, Day 2 (Tonelli's Theorem)
**Status:** Ready for re-review
